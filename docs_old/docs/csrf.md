# ๐ก๏ธ ุญููู CSRF ฺู ู ฺฺฏููู ุงุฒ ุงูู ุฌููฺฏุฑ ฺฉููุ

## ๐ CSRF ฺูุ

CSRF ุง "ุชููุจ ุฏุฑ ุฏุฑุฎูุงุณุชโูุง ูุชูุงุจู" (Cross-Site Request Forgery) ููุน ุญููู ุชุญุช ูุจ ุงุณุช ฺฉู ุฏุฑ ุขู ุญูููโฺฏุฑ ุจุง ูุฑุจ ฺฉุงุฑุจุฑุ ุจุฏูู ุงูฺฉู ุงู ูุชูุฌู ุดูุฏุ ุฏุฑุฎูุงุณุชโูุง ูุงุฎูุงุณุชูโุง ุจู ุณุงุช ฺฉู ูุจูุงู ูุงุฑุฏ ุขู ุดุฏู ุงุฑุณุงู ูโฺฉูุฏ. ุงู ุญููู ุงุฒ ุงุนุชูุงุฏ ููุฌูุฏ ุจู ูุฑูุฑฺฏุฑ ฺฉุงุฑุจุฑ ู ุณุฑูุฑ ุณูุก ุงุณุชูุงุฏู ูโฺฉูุฏุ ฺุฑุง ฺฉู ูุฑูุฑฺฏุฑ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ฺฉูฺฉโูุง ู ุงุทูุงุนุงุช ุงุญุฑุงุฒ ููุช ุฑุง ุฏุฑ ูุฑ ุฏุฑุฎูุงุณุช ุงุฑุณุงู ูโฺฉูุฏ. ุฏุฑ ูุชุฌูุ ุญุช ุงฺฏุฑ ฺฉุงุฑุจุฑ ุขฺฏุงู ูุจุงุดุฏุ ุฏุฑุฎูุงุณุชโูุง ูุฎุฑุจ ฺฉู ุชูุณุท ุญูููโฺฏุฑ ุชูุธู ุดุฏูโุงูุฏุ ููฺฉู ุงุณุช ุจู ุนููุงู ุฏุฑุฎูุงุณุชโูุง ูุนุชุจุฑ ุดูุงุฎุชู ุดุฏู ู ุงุฌุฑุง ุดููุฏ. ุงู ููุถูุน ูโุชูุงูุฏ ููุฌุฑ ุจู ุชุบุฑ ุงุทูุงุนุงุช ุญุณุงุจ ฺฉุงุฑุจุฑุ ุงูุชูุงู ูุฌููุ ุชุบุฑ ุชูุธูุงุช ุงููุช ุง ุงูุดุง ุฏุงุฏูโูุง ุญุณุงุณ ุดูุฏ. ุจุฑุฎูุงู ุญููุงุช XSS ฺฉู ฺฉุฏ ูุฎุฑุจ ุฏุฑ ุณุงุช ูุฏู ุชุฒุฑู ูโุดูุฏุ ุฏุฑ CSRF ุฎูุฏ ุณุงุช ูุฏู ููุฑุฏ ุญููู ูุฑุงุฑ ููโฺฏุฑุฏ ุจูฺฉู ุงุฒ ุงุนุชุจุงุฑ ฺฉุงุฑุจุฑ ุงุณุชูุงุฏู ูโุดูุฏ.

---

## โ๏ธ ูุซุงูโูุง ูุงูุน ุงุฒ ุญููุงุช CSRF

### ฑ. ุชุบุฑ ุชูุธูุงุช ุงููุช ุญุณุงุจ ฺฉุงุฑุจุฑ ุฏุฑ ฺฉ ุณุฑูุณ ุงูู

ูุฑุถ ฺฉูุฏ ฺฉุงุฑุจุฑ ุฏุฑ ุณุฑูุณ ุงูู ุฎูุฏ (ูุซูุงู `mail.com`) ูุงุฑุฏ ุญุณุงุจ ฺฉุงุฑุจุฑ ุดุฏู ู ุฏุณุชุฑุณ ูุงุฒู ุจุฑุง ุชุบุฑ ุชูุธูุงุช ุงููุชุ ูุงููุฏ ุชุบุฑ ุฑูุฒ ุนุจูุฑ ุง ูุนุงูโุณุงุฒ ุงุญุฑุงุฒ ููุช ุฏู ูุฑุญููโุง ุฑุง ุฏุงุฑุฏ. ฺฉ ุญูููโฺฏุฑ ูโุชูุงูุฏ ุตูุญูโุง ุทุฑุงุญ ฺฉูุฏ ฺฉู ุฏุฑ ูพุณโุฒููู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏุฑุฎูุงุณุช ุชุบุฑ ุฑูุฒ ุนุจูุฑ ู ูุนุงูโุณุงุฒ ุชูุธูุงุช ุงููุช ุฑุง ุงุฑุณุงู ฺฉูุฏ. ุจู ุนููุงู ูุซุงู:

```html
<img src="https://mail.com/update-settings?password=newSecretPass123&enable_2FA=true" style="display:none;" />
```

ุฏุฑ ุงู ุณูุงุฑูุ ุงฺฏุฑ ฺฉุงุฑุจุฑ ููุฒูุงู ุฏุฑ ุณุงุช ุฏฺฏุฑ ุญุถูุฑ ุฏุงุดุชู ุจุงุดุฏ ุง ุตูุญูโ ูุฎุฑุจ ุจุงุฒ ุดูุฏุ ูุฑูุฑฺฏุฑ ุงุทูุงุนุงุช ุงุญุฑุงุฒ ููุช (ฺฉูฺฉโูุง) ุฑุง ุจู ููุฑุงู ุฏุฑุฎูุงุณุช ุงุฑุณุงู ูโฺฉูุฏ ู ุชุบุฑุงุช ูุงุฎูุงุณุชู ุงุนูุงู ูโุดูุฏ. ุงู ูุซุงู ูพฺุฏูโุชุฑ ู ูุงูุนโุชุฑ ุงุณุช ฺุฑุง ฺฉู ุชุบุฑ ุชูุธูุงุช ุงููุชุ ุจู ูฺู ุชุบุฑ ุฑูุฒ ุนุจูุฑ ู ูุนุงูโุณุงุฒ ุงุญุฑุงุฒ ููุช ุฏู ูุฑุญููโุงุ ูโุชูุงูุฏ ฺฉูุชุฑู ฺฉุงูู ุญุณุงุจ ฺฉุงุฑุจุฑ ุฑุง ุจู ุฏุณุช ุญูููโฺฏุฑ ุจุฏูุฏ.

---

### ฒ. ุชุบุฑ ุงูู ฺฉุงุฑุจุฑ ุจุฏูู ุงุฌุงุฒู

ฺฉ ุญูููโฺฏุฑ ูโุชูุงูุฏ ูุฑู ูุฎุฑุจ ุฒุฑ ุฑุง ุฏุฑ ฺฉ ุงูู ุง ุตูุญู ูุจ ุฌุงุณุงุฒ ฺฉูุฏ:

```html
<form action="https://social.com/update-email" method="POST">
  <input type="hidden" name="email" value="hacker@mail.com" />
  <input type="submit" />
</form>
<script>
  document.forms[0].submit();
</script>
```

ุจุง ุงุฑุณุงู ุฎูุฏฺฉุงุฑ ุงู ูุฑูุ **ุงูู ุญุณุงุจ ฺฉุงุฑุจุฑ ุจู ุขุฏุฑุณ ูฺฉุฑ ุชุบุฑ ุฏุงุฏู ูโุดูุฏ** ู ฺฉูุชุฑู ุญุณุงุจ ุจู ุฏุณุช ููุงุฌู ูโุงูุชุฏ. ๐ฑ

---

## ๐ ุฑูุดโูุง ุฌููฺฏุฑ ุงุฒ CSRF ู ุชูุถุญุงุช ุขูโูุง

### โ ฑ. ุงุณุชูุงุฏู ุงุฒ ุชูฺฉู CSRF (ุจูุชุฑู ุฑูุด)

**ุชูุถุญ:**  
ุณุฑูุฑ ุจุฑุง ูุฑ ูุฑู ฺฉ ุชูฺฉู ฺฉุชุง ู ุชุตุงุฏู ุชููุฏ ูโฺฉูุฏ ฺฉู ุฏุฑ ูุฑู ุจู ุนููุงู ฺฉ ูุฑูุฏ ูุฎู ูุฑุงุฑ ูโฺฏุฑุฏ. ููฺฏุงู ุงุฑุณุงู ูุฑูุ ุณุฑูุฑ ุชูฺฉู ุงุฑุณุงู ุดุฏู ุฑุง ุจุง ุชูฺฉู ุฐุฎุฑูโุดุฏู ููุงุณู ูโฺฉูุฏ. ุงฺฏุฑ ุชูฺฉูโูุง ูุทุงุจูุช ูุฏุงุดุชู ุจุงุดูุฏุ ุฏุฑุฎูุงุณุช ุฑุฏ ูโุดูุฏ. ุงู ุฑูุด ููุซุฑ ุงุณุช ุฒุฑุง ุญูููโฺฏุฑ ุจู ุณุงุฏฺฏ ููโุชูุงูุฏ ุชูฺฉู ุชุตุงุฏู ู ฺฉุชุง ุฑุง ูพุดโุจู ุง ุงุณุชุฎุฑุงุฌ ฺฉูุฏ.

```html
<form action="/transfer" method="POST">
  <input type="hidden" name="csrf_token" value="random12345" />
  <input type="text" name="amount" />
  <input type="submit" value="ุงูุชูุงู ูุฌู" />
</form>
```

---

### โ ฒ. ุชูุธู `SameSite` ุจุฑุง ฺฉูฺฉโูุง

**ุชูุถุญ:**  
ูฺฺฏ `SameSite` ุฏุฑ ฺฉูฺฉโูุง ุชุนู ูโฺฉูุฏ ฺฉู ฺฉูฺฉโูุง ุชููุง ุฏุฑ ุฏุฑุฎูุงุณุชโูุง ฺฉู ุงุฒ ุฏุงูููโ ุงุตู ุงุฑุณุงู ูโุดููุฏุ ฺฏูุฌุงูุฏู ุดููุฏ. ุจุง ุชูุธู `SameSite=Strict` ุง `SameSite=Lax`ุ ุญุช ุงฺฏุฑ ุฏุฑุฎูุงุณุช ุงุฒ ฺฉ ุฏุงููู ุฎุงุฑุฌ ุงุฑุณุงู ุดูุฏุ ฺฉูฺฉโูุง ูุฑุจูุท ุจู ุงุญุฑุงุฒ ููุช ุงุฑุณุงู ูุฎูุงููุฏ ุดุฏ. ุจู ุงู ุชุฑุชุจุ ุญูููโฺฏุฑ ฺฉู ุฏุฑ ุฏุงููู ุฏฺฏุฑ ูุนุงูุช ูโฺฉูุฏุ ููโุชูุงูุฏ ุจู ุงุทูุงุนุงุช ุญุณุงุณ ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏ.

**ููููู ฺฉุฏ ุฏุฑ Express.js:**

```javascript
app.use(
  cookieSession({
    name: "session",
    secret: "supersecret",
    cookie: { sameSite: "Strict" },
  })
);
```

---

### โ ณ. ุจุฑุฑุณ ูุฏุฑูุง `Origin` ู `Referer`

**ุชูุถุญ:**  
ุฏุฑ ุงู ุฑูุดุ ุณุฑูุฑ ูุจุฏุง ุฏุฑุฎูุงุณุช (ุฏุงูููโุง ฺฉู ุฏุฑุฎูุงุณุช ุงุฒ ุขู ุงุฑุณุงู ุดุฏู) ุฑุง ุงุฒ ุทุฑู ูุฏุฑูุง `Origin` ุง `Referer` ุจุฑุฑุณ ูโฺฉูุฏ. ุงฺฏุฑ ุฏุงููู ูุจุฏุง ุจุง ุฏุงููู ูุนุชุจุฑ ูุทุงุจูุช ูุฏุงุดุชู ุจุงุดุฏุ ุฏุฑุฎูุงุณุช ุฑุฏ ูโุดูุฏ. ุงู ุงูุฏุงู ุชุถูู ูโฺฉูุฏ ฺฉู ููุท ุฏุฑุฎูุงุณุชโูุง ุงุฑุณุงู ุงุฒ ููุงุจุน ูุนุชุจุฑ ูพุฑุฏุงุฒุด ุดููุฏ ู ุงุฒ ุฏุฑุฎูุงุณุชโูุง ูุฎุฑุจ ฺฉู ุงุฒ ุฏุงูููโูุง ูุงูุนุชุจุฑ ุงุฑุณุงู ุดุฏูโุงูุฏุ ุฌููฺฏุฑ ูโุดูุฏ.

**ููููู ฺฉุฏ ุฏุฑ Flask (ูพุงุชูู):**

```python
from flask import request, abort

@app.route('/transfer', methods=['POST'])
def transfer():
    if request.headers.get('Origin') != 'https://bank.com':
        abort(403)
    # ูพุฑุฏุงุฒุด ุฏุฑุฎูุงุณุช
```

---

### โ ด. ุงุณุชูุงุฏู ุงุฒ ุฑูุฒ ุนุจูุฑ/OTP ุจุฑุง ุนููุงุช ุญุณุงุณ

**ุชูุถุญ:**  
ุฏุฑ ุจุฑุฎ ุนููุงุชโูุง ุญุณุงุณ ูุงููุฏ ุชุบุฑ ุฑูุฒ ุนุจูุฑ ุง ุงูุชูุงู ูุฌูุ ุญุช ุงฺฏุฑ ุฏุฑุฎูุงุณุช ูุฎุฑุจ ุงุฒ ุทุฑู CSRF ุงุฑุณุงู ุดูุฏุ ุงุถุงูู ฺฉุฑุฏู ฺฉ ูุงู ุงููุช ุงุถุงู ูุงููุฏ ุฏุฑุฎูุงุณุช ุฑูุฒ ุนุจูุฑ ุง OTP (ุฑูุฒ ฺฉุจุงุฑ ูุตุฑู) ุงุฒ ฺฉุงุฑุจุฑุ ุชุถูู ูโฺฉูุฏ ฺฉู ุนููุงุช ุชููุง ุจุง ุชุงุฏ ุตุฑุญ ฺฉุงุฑุจุฑ ุงูุฌุงู ุดูุฏ. ุงู ุฑูุด ูุงูุน ุงุฒ ุงุฌุฑุง ุฎูุฏฺฉุงุฑ ุนููุงุชโูุง ุญุณุงุณ ุจุฏูู ุขฺฏุงู ู ุชุฃุฏ ฺฉุงุฑุจุฑ ูโุดูุฏ.

---

### โ ต. ุนุฏู ุงุณุชูุงุฏู ุงุฒ ูุชุฏ `GET` ุจุฑุง ุนููุงุช ุญุณุงุณ

**ุชูุถุญ:**  
ูุชุฏ GET ุจุฑุง ุฏุฑุงูุช ุงุทูุงุนุงุช ุทุฑุงุญ ุดุฏู ู ุงุณุชูุงุฏู ุงุฒ ุขู ุฏุฑ ุนููุงุชโูุง ุชุบุฑโุฏููุฏู ูุถุนุช ูุงููุฏ ุงูุชูุงู ูุฌู ุง ุชุบุฑ ุชูุธูุงุช ูโุชูุงูุฏ ุฎุทุฑูุงฺฉ ุจุงุดุฏุ ุฒุฑุง ุฏุฑุฎูุงุณุชโูุง GET ุจูโุฑุงุญุช ุงุฒ ุทุฑู ููฺฉโูุงุ ุชุตุงูุฑ ุง ุณุงุฑ ุงููุงูโูุง HTML ุงุฌุงุฏ ูโุดููุฏ. ุงุณุชูุงุฏู ุงุฒ ูุชุฏ POST ฺฉู ูุงุฒููุฏ ฺฉ ูุฑู ุง ุฏุฑุฎูุงุณุช ุขฺฏุงูุงูู ฺฉุงุฑุจุฑ ุงุณุชุ ูุงูุน ุงุฒ ุจุฑูุฒ ุญููุงุช CSRF ูโุดูุฏ.

โ **ููููู ูุงุฏุฑุณุช:**

```html
<a href="https://bank.com/transfer?to=attacker&amount=1000000">ุงูุชูุงู ูุฌู</a>
```

โ **ููููู ุตุญุญ:**

```html
<form action="/transfer" method="POST">
  <input type="text" name="amount" />
  <input type="submit" value="ุงูุชูุงู ูุฌู" />
</form>
```

---

## ๐ฏ ุฌูุนโุจูุฏ

ุจุฑุง ููุงุจูู ุจุง ุญููุงุช CSRF:

- โ๏ธ ุงุฒ **ุชูฺฉู CSRF** ุฏุฑ ูุฑูโูุง ุงุณุชูุงุฏู ฺฉูุฏุ ุฒุฑุง ุงู ุชูฺฉูโูุง ุชููุง ฺฉุจุงุฑ ูุงุจู ุงุณุชูุงุฏู ูุณุชูุฏ ู ุงุฒ ูพุดโุจู ุขูโูุง ุชูุณุท ุญูููโฺฏุฑ ุฌููฺฏุฑ ูโุดูุฏ.
- โ๏ธ ฺฉูฺฉโูุง ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูฺฺฏ `SameSite` ูุญุฏูุฏ ฺฉูุฏ ุชุง ุงุฒ ุงุฑุณุงู ุฎูุฏฺฉุงุฑ ฺฉูฺฉโูุง ุฏุฑ ุฏุฑุฎูุงุณุชโูุง ูุงูโุฏุงููู ุฌููฺฏุฑ ุดูุฏ.
- โ๏ธ ูุฏุฑูุง `Origin` ู `Referer` ุฑุง ุจุฑุฑุณ ฺฉูุฏ ุชุง ุงุทููุงู ุญุงุตู ุดูุฏ ฺฉู ุฏุฑุฎูุงุณุช ุงุฒ ุฏุงููู ูุนุชุจุฑ ุงุฑุณุงู ุดุฏู ุงุณุช.
- โ๏ธ ุจุฑุง ุนููุงุช ุญุณุงุณ ุงุฒ **ุชุฃุฏ ุฏู ูุฑุญููโุง (ุฑูุฒ ุนุจูุฑ ุง OTP)** ุงุณุชูุงุฏู ฺฉูุฏ ุชุง ุญุช ุฏุฑ ุตูุฑุช ููููุช ฺฉ ุญููู CSRFุ ุนููุงุช ุจุฏูู ุชุงุฏ ฺฉุงุฑุจุฑ ุงูุฌุงู ูุดูุฏ.
- โ๏ธ ุงุฒ ูุชุฏ `POST` ุจู ุฌุง `GET` ุจุฑุง ุฏุฑุฎูุงุณุชโูุง ุญุณุงุณ ุงุณุชูุงุฏู ฺฉูุฏ ุชุง ุงุฒ ุจุฑูุฒ ุฏุฑุฎูุงุณุชโูุง ูุงุฎูุงุณุชู ุงุฒ ุทุฑู ููฺฉโูุง ุง ุชุตุงูุฑ ุฌููฺฏุฑ ุดูุฏ.

ุจุง ุงู ุงูุฏุงูุงุช ู ูพุงุฏูโุณุงุฒ ูุงูโูุง ูุชุนุฏุฏ ุงููุชุ ูโุชูุงูุฏ ุงููุช ุจุฑูุงููโูุง ูุจ ุฎูุฏ ุฑุง ุฏุฑ ุจุฑุงุจุฑ ุญููุงุช CSRF ุจู ุทูุฑ ูุงุจู ุชูุฌู ุงูุฒุงุด ุฏูุฏ! ๐

---
#### ๐ฅ Contributors

<a href="https://github.com/amirmahdimaleki">
<img src="https://github.com/amirmahdimaleki.png" width="80px;" alt="Mohammad Mohagheghian" style="border-radius: 50%;"/> 
</a>
